
loadDotEnv() {
  local envFile="${1?Missing environment file}"
  local environmentAsArray variableDeclaration
  mapfile environmentAsArray < <(
    grep --invert-match '^#' "${envFile}" \
      | grep --invert-match '^\s*$'
  ) # Uses grep to remove commented and blank lines
  for variableDeclaration in "${environmentAsArray[@]}"; do
    IFS='=' read -ra splitDeclaration <<< "${variableDeclaration}"
    local envVarValue=$(eval echo \$${splitDeclaration[0]})
    if [ -z "${envVarValue}" ] ; then
      export "${variableDeclaration//[$'\r\n']}" # The substitution removes the line breaks
    fi
  done
}
